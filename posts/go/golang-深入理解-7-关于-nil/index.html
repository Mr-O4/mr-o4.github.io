<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Golang [深入理解] 7-关于 nil | Mr.Boii</title><meta name=keywords content="Golang,引用类型"><meta name=description content="关于你可能知道的 nil 的使用"><meta name=author content="Boii"><link rel=canonical href=https://boii.xyz/posts/go/golang-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3-7-%E5%85%B3%E4%BA%8E-nil/><link crossorigin=anonymous href=/assets/css/stylesheet.min.30c0c973d02d0622251a43d6856208a4b7655389233c0e74e71274fc9f3dc8dd.css integrity="sha256-MMDJc9AtBiIlGkPWhWIIpLdlU4kjPA505xJ0/J89yN0=" rel="preload stylesheet" as=style><link rel=icon href=https://boii.xyz/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://boii.xyz/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://boii.xyz/favicon-32x32.png><link rel=apple-touch-icon href=https://boii.xyz/apple-touch-icon.png><link rel=mask-icon href=https://boii.xyz/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=text/javascript async src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["[[","]]"]],processEscapes:!0,processEnvironments:!0,skipTags:["script","noscript","style","textarea","pre"],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}}),MathJax.Hub.Queue(function(){var e,t=MathJax.Hub.getAllJax();for(e=0;e<t.length;e+=1)t[e].SourceElement().parentNode.className+=" has-jax"})</script><style>code.has-jax{font:inherit;font-size:100%;background:inherit;border:inherit;color:#515151}</style><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Golang [深入理解] 7-关于 nil"><meta property="og:description" content="关于你可能知道的 nil 的使用"><meta property="og:type" content="article"><meta property="og:url" content="https://boii.xyz/posts/go/golang-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3-7-%E5%85%B3%E4%BA%8E-nil/"><meta property="og:image" content="https://boii.xyz/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-09-14T15:09:02+00:00"><meta property="article:modified_time" content="2021-09-14T15:09:02+00:00"><meta property="og:site_name" content="Mr.Boii"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://boii.xyz/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Golang [深入理解] 7-关于 nil"><meta name=twitter:description content="关于你可能知道的 nil 的使用"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://boii.xyz/posts/"},{"@type":"ListItem","position":2,"name":"Golang [深入理解] 7-关于 nil","item":"https://boii.xyz/posts/go/golang-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3-7-%E5%85%B3%E4%BA%8E-nil/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Golang [深入理解] 7-关于 nil","name":"Golang [深入理解] 7-关于 nil","description":"关于你可能知道的 nil 的使用\n","keywords":["Golang","引用类型"],"articleBody":"关于你可能知道的 nil 的使用\n关于 nil nil 是啥？golang 中的 nil 相当于其他语言中的 NULL。\n但 nil 的本质是啥？到底是一种类型？还是一种变量？还是一个关键字？\n按照博主 奇伢云存储 的介绍，nil 是一个特殊变量，也是一种触发机制。\n 1 2 3 4 5 6 7 8  // nil is a predeclared identifier representing the zero value for a // pointer, channel, func, interface, map, or slice type. var nil Type // Type must be a pointer, channel, func, interface, map, or slice type  // Type is here for the purposes of documentation only. It is a stand-in // for any Go type, but represents the same type for any given function // invocation. type Type int   在编译器层面，nil 是使用一个变量来表示。\n nil 其实是语言层面给出的：在编译器中，nil 是一个 Type 型变量，Type 类型 是以 int 为基础的自定义类型。\n但这不代表我们使用语言编程程序时能把 nil 当作一个变量。比如你把 nil 赋值给一个 byte 型变量，是不可以的，因为编译器不让。这是编译器的特权，你可没有！\n这里明确一点，能够赋值 nil 的类型只有 “引用六兄弟 SMCIFP”：\n slice map chan interface func pointer  这就是编译器给你这位语言使用者的权限。在上面的源码中 var nil Type 后面的注释就有写。\n所以除了这 6 兄弟之外，别的类型都不可以赋值 nil，或者和 nil 比较。\n 你可以把这 “引用六兄弟 SMCIFP” 理解为一种 nilable 的类型。\n所谓 nilable，就是可以赋值为 nil（able to assign with nil），可以和 nil 比较（able to compare to nil）。\n如果用 go 提案中用泛型表示，即：\n1 2 3 4 5 6 7 8 9 10 11  type nilable interface { type []int, map[int]int, chan int, interface{}, unsafe.Pointer, func } func compare[T nilable] (a T) bool { return a == nil } func assign[T nilable] (a T) { a = nil }   并不严谨，仅仅用于表达 nilable 这个意思而已。\n 于是在编译器编译你的代码的时候，如果它看到你写出 a == nil 或 a = nil 这样的代码时，它要确认 a 是 nilable 的（是引用六兄弟 SMCIFP）。所以说 nil 是一种触发机制。\n那么这六兄弟有什么特殊呢？\n我们将 go 中的类型分为值类型和引用类型 两类。\n 值类型就是 int 系列、uint 系列等； 引用类型就是 “引用六兄弟 SMCIFP”。  在 golang 中，使用变量前需要先声明变量。声明变量的本质是分配一块内存。\nClang（golang 的前辈）在声明变量是分配内存，但也只是分配内存，并不管这块内存里是不是干净的，所以会出现野指针此类问题。\n我写 Clang 的时候就会有一个习惯，在声明变量的时候顺带初始化一个零值。\n1 2 3  int sum = 0; double price = 0.0; int* p = NULL;   这样的习惯可以有效的预防一些意料之外的情况。\n但是 golang 是二十一世纪的语言，它的变量声明在分配内存时是「置 0 分配」，也就是说 golang 可以保证你声明的变量分配的那块内存是干净的，你可以放心的使用。\n所以在 golang 中声明一个变量但没有初始化，这个变量的值是其类型的零值，即：\n1 2 3  var sum int // sum == 0 var str string // str == \"\" var p *int // p == nil   SMCIFP  先声明一点：这六兄弟中，slice、map、chan、interface 是一种复合结构，pointer 和 func 是一个指针。\n 其实上面引用中的这句话已经能大概的看出答案了，因为他们是指针，所以是 nilable。我们可以看看编译器中这“六兄弟”的结构。\nslice\n1 2 3 4 5  type slice struct { array unsafe.Pointer // 管理的内存块首地址  len int // 动态数组实际使用大小  cap int // 动态数组内存大小 }   map\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  // A header for a Go map. type hmap struct { // Note: the format of the hmap is also encoded in cmd/compile/internal/gc/reflect.go.  // Make sure this stays in sync with the compiler's definition.  count int // # live cells == size of map. Must be first (used by len() builtin)  flags uint8 B uint8 // log_2 of # of buckets (can hold up to loadFactor * 2^B items)  noverflow uint16 // approximate number of overflow buckets; see incrnoverflow for details  hash0 uint32 // hash seed  buckets unsafe.Pointer // array of 2^B Buckets. may be nil if count==0.  oldbuckets unsafe.Pointer // previous bucket array of half the size, non-nil only when growing  nevacuate uintptr // progress counter for evacuation (buckets less than this have been evacuated)  extra *mapextra // optional fields }   chan\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  type hchan struct { qcount uint // total data in the queue  dataqsiz uint // size of the circular queue  buf unsafe.Pointer // points to an array of dataqsiz elements  elemsize uint16 closed uint32 elemtype *_type // element type  sendx uint // send index  recvx uint // receive index  recvq waitq // list of recv waiters  sendq waitq // list of send waiters  // lock protects all fields in hchan, as well as several  // fields in sudogs blocked on this channel.  //  // Do not change another G's status while holding this lock  // (in particular, do not ready a G), as this can deadlock  // with stack shrinking.  lock mutex }   interface\n1 2 3 4 5 6 7 8 9  type iface struct { tab *itab data unsafe.Pointer } type eface struct { _type *_type data unsafe.Pointer }   func 和 pointer 本身就是一个指针。\n可以看出，map 和 chan 两个都是比较大的结构体，而当你声明一个 map 或 chan 时，你必须通过 make() 才能使用。为什么？\n因为这两个结构体比较大，为了提高性能，你声明的时候 var c chan int 的时候，c 是个指针，当你 make() 的时候才会分配内存，也就是初始化 hchan。map 也是同样的道理。\n像图中那样，slice、map、chan、interface 不管他们有多大，例如 slice 有 1000 个元素，map 有 10万对键值对，chan 缓存中有 100万 个数据，那都是他们背后的数组的大小；他们本身的大小，只有一个结构体那么大。\n所以编译器在判断 nil 的时候其实非常快，因为这几个类型本身是指针，编译器只需要像如下判断即可：\n 对于 slice 的时候，判断 s 中的 array 字段是不是零值； 对于 map、chan 的时候，判断 m、c 自身是不是零值； 对于 interface 的时候，判断 i 自身是不是零值； 对于 pointer、func 的时候，判断 p、f 自身是不是零值；  同样，在赋值 nil 的时候，也是把他们自身赋值为 nil 即可。\n除了 slice，因为它的结构比较小，总共就 24Byte（32位机中 12B），所以声明的时候直接初始化了一个 slice 结构，对 array 字段进行维护。\n具体细节，推荐仔细阅读 https://mp.weixin.qq.com/s/sHLYy_4XA6254-vLmlu0IA，这篇文章讲的非常通俗和详细。\n总结  nil 只能用于引用六兄弟 SMCIFP； 变量只是一个指向一块内存的指针 slice 结构较小，所以声明的时候就直接分配内存了，map 和 chan 需要 make() 才分配内存。 除了 pointer 和 func，其他都是使用对应结构体来管理 对 MCIFP 的判断 nil 和 赋值 nil，都是对变量本身进行操作，而 Slice 是对 array 字段进行操作。  再次强烈推荐阅读 https://mp.weixin.qq.com/s/sHLYy_4XA6254-vLmlu0IA。\n","wordCount":"740","inLanguage":"en","datePublished":"2021-09-14T15:09:02Z","dateModified":"2021-09-14T15:09:02Z","author":{"@type":"Person","name":"Boii"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://boii.xyz/posts/go/golang-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3-7-%E5%85%B3%E4%BA%8E-nil/"},"publisher":{"@type":"Organization","name":"Mr.Boii","logo":{"@type":"ImageObject","url":"https://boii.xyz/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://boii.xyz/ accesskey=h title="Boii (Alt + H)"><img src=https://boii.xyz/apple-touch-icon.png alt=logo aria-label=logo height=35>Boii</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://boii.xyz/archives title=Archive><span>Archive</span></a></li><li><a href=https://boii.xyz/categories/ title=categories><span>categories</span></a></li><li><a href=https://boii.xyz/tags/ title=tags><span>tags</span></a></li><li><a href=https://boii.xyz/me title=me><span>me</span></a></li><li><a href=https://boii.xyz/search/ title="🔍 (Alt + /)" accesskey=/><span><i class="fa-solid fa-magnifying-glass"></i>🔍</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://boii.xyz/>Home</a>&nbsp;»&nbsp;<a href=https://boii.xyz/posts/>Posts</a></div><h1 class=post-title>Golang [深入理解] 7-关于 nil</h1><div class=post-meta><span title="2021-09-14 15:09:02 +0000 UTC">September 14, 2021</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Boii</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%85%b3%e4%ba%8e-nil aria-label="关于 nil">关于 nil</a><ul><li><a href=#smcifp aria-label=SMCIFP>SMCIFP</a></li><li><a href=#%e6%80%bb%e7%bb%93 aria-label=总结>总结</a></li></ul></li></ul></div></details></div><div class=post-content><p>关于你可能知道的 nil 的使用</p><h1 id=关于-nil>关于 nil<a hidden class=anchor aria-hidden=true href=#关于-nil>#</a></h1><p><code>nil</code> 是啥？golang 中的 nil 相当于其他语言中的 NULL。</p><p>但 nil 的本质是啥？到底是一种类型？还是一种变量？还是一个关键字？</p><p>按照博主 <a href=https://mp.weixin.qq.com/s/sHLYy_4XA6254-vLmlu0IA>奇伢云存储</a> 的介绍，nil 是一个特殊变量，也是一种触发机制。</p><blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// nil is a predeclared identifier representing the zero value for a
</span></span></span><span class=line><span class=cl><span class=c1>// pointer, channel, func, interface, map, or slice type.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=kc>nil</span> <span class=nx>Type</span> <span class=c1>// Type must be a pointer, channel, func, interface, map, or slice type
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// Type is here for the purposes of documentation only. It is a stand-in
</span></span></span><span class=line><span class=cl><span class=c1>// for any Go type, but represents the same type for any given function
</span></span></span><span class=line><span class=cl><span class=c1>// invocation.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>Type</span> <span class=kt>int</span>
</span></span></code></pre></td></tr></table></div></div><p>在编译器层面，nil 是使用一个变量来表示。</p></blockquote><p>nil 其实是语言层面给出的：在编译器中，nil 是一个 Type 型变量，Type 类型 是以 int 为基础的自定义类型。</p><p>但这不代表我们使用语言编程程序时能把 nil 当作一个变量。比如你把 nil 赋值给一个 byte 型变量，是不可以的，因为编译器不让。这是编译器的特权，你可没有！</p><p>这里明确一点，能够赋值 nil 的类型只有 “引用六兄弟 SMCIFP”：</p><ul><li><code>slice</code></li><li><code>map</code></li><li><code>chan</code></li><li><code>interface</code></li><li><code>func</code></li><li><code>pointer</code></li></ul><p>这就是编译器给你这位语言使用者的权限。在上面的源码中 <code>var nil Type</code> 后面的注释就有写。</p><p>所以除了这 6 兄弟之外，别的类型都<strong>不可以</strong>赋值 nil，或者和 nil 比较。</p><blockquote><p>你可以把这 “引用六兄弟 SMCIFP” 理解为一种 nilable 的类型。</p><p>所谓 nilable，就是可以赋值为 nil（able to assign with nil），可以和 nil 比较（able to compare to nil）。</p><p>如果用 go 提案中用泛型表示，即：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>nilable</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>type</span> <span class=p>[]</span><span class=kt>int</span><span class=p>,</span> <span class=kd>map</span><span class=p>[</span><span class=kt>int</span><span class=p>]</span><span class=kt>int</span><span class=p>,</span> <span class=kd>chan</span> <span class=kt>int</span><span class=p>,</span> <span class=kd>interface</span><span class=p>{},</span> <span class=nx>unsafe</span><span class=p>.</span><span class=nx>Pointer</span><span class=p>,</span> <span class=kd>func</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nx>compare</span><span class=p>[</span><span class=nx>T</span> <span class=nx>nilable</span><span class=p>]</span> <span class=p>(</span><span class=nx>a</span> <span class=nx>T</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>a</span> <span class=o>==</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nx>assign</span><span class=p>[</span><span class=nx>T</span> <span class=nx>nilable</span><span class=p>]</span> <span class=p>(</span><span class=nx>a</span> <span class=nx>T</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>a</span> <span class=p>=</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>并不严谨，仅仅用于表达 nilable 这个意思而已。</p></blockquote><p>于是在编译器编译你的代码的时候，如果它看到你写出 <code>a == nil</code> 或 <code>a = nil</code> 这样的代码时，它要确认 a 是 nilable 的（是引用六兄弟 SMCIFP）。所以说 nil 是一种触发机制。</p><p>那么这六兄弟有什么特殊呢？</p><p>我们将 go 中的类型分为<code>值类型</code>和<code>引用类型</code> 两类。</p><ul><li>值类型就是 int 系列、uint 系列等；</li><li>引用类型就是 “引用六兄弟 SMCIFP”。</li></ul><p>在 golang 中，使用变量前需要先声明变量。声明变量的本质是分配一块内存。</p><p>Clang（golang 的前辈）在声明变量是分配内存，但也只是分配内存，并不管这块内存里是不是干净的，所以会出现野指针此类问题。</p><p>我写 Clang 的时候就会有一个习惯，在声明变量的时候顺带初始化一个零值。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>int</span> <span class=n>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>double</span> <span class=n>price</span> <span class=o>=</span> <span class=mf>0.0</span><span class=p>;</span> 
</span></span><span class=line><span class=cl><span class=kt>int</span><span class=o>*</span> <span class=n>p</span> <span class=o>=</span> <span class=nb>NULL</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><p>这样的习惯可以有效的预防一些意料之外的情况。</p><p>但是 golang 是二十一世纪的语言，它的变量声明在分配内存时是「置 0 分配」，也就是说 golang 可以保证你声明的变量分配的那块内存是干净的，你可以放心的使用。</p><p>所以在 golang 中声明一个变量但没有初始化，这个变量的值是其类型的零值，即：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>var</span> <span class=nx>sum</span> <span class=kt>int</span>     <span class=c1>// sum == 0
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>str</span> <span class=kt>string</span>  <span class=c1>// str == &#34;&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>p</span> <span class=o>*</span><span class=kt>int</span>      <span class=c1>// p == nil
</span></span></span></code></pre></td></tr></table></div></div><h2 id=smcifp>SMCIFP<a hidden class=anchor aria-hidden=true href=#smcifp>#</a></h2><blockquote><p>先声明一点：这六兄弟中，slice、map、chan、interface 是一种复合结构，pointer 和 func 是一个指针。</p></blockquote><p>其实上面引用中的这句话已经能大概的看出答案了，因为他们是指针，所以是 nilable。我们可以看看编译器中这“六兄弟”的结构。</p><p>slice</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>slice</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nx>array</span> <span class=nx>unsafe</span><span class=p>.</span><span class=nx>Pointer</span>         <span class=c1>// 管理的内存块首地址
</span></span></span><span class=line><span class=cl><span class=c1></span>   <span class=nx>len</span>   <span class=kt>int</span>                    <span class=c1>// 动态数组实际使用大小
</span></span></span><span class=line><span class=cl><span class=c1></span>   <span class=nx>cap</span>   <span class=kt>int</span>                    <span class=c1>// 动态数组内存大小
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>map</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// A header for a Go map.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>hmap</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Note: the format of the hmap is also encoded in cmd/compile/internal/gc/reflect.go.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// Make sure this stays in sync with the compiler&#39;s definition.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>count</span>     <span class=kt>int</span> <span class=c1>// # live cells == size of map.  Must be first (used by len() builtin)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>flags</span>     <span class=kt>uint8</span>
</span></span><span class=line><span class=cl>    <span class=nx>B</span>         <span class=kt>uint8</span>  <span class=c1>// log_2 of # of buckets (can hold up to loadFactor * 2^B items)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>noverflow</span> <span class=kt>uint16</span> <span class=c1>// approximate number of overflow buckets; see incrnoverflow for details
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>hash0</span>     <span class=kt>uint32</span> <span class=c1>// hash seed
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>buckets</span>    <span class=nx>unsafe</span><span class=p>.</span><span class=nx>Pointer</span> <span class=c1>// array of 2^B Buckets. may be nil if count==0.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>oldbuckets</span> <span class=nx>unsafe</span><span class=p>.</span><span class=nx>Pointer</span> <span class=c1>// previous bucket array of half the size, non-nil only when growing
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>nevacuate</span>  <span class=kt>uintptr</span>        <span class=c1>// progress counter for evacuation (buckets less than this have been evacuated)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>extra</span> <span class=o>*</span><span class=nx>mapextra</span> <span class=c1>// optional fields
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>chan</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>hchan</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>qcount</span>   <span class=kt>uint</span>           <span class=c1>// total data in the queue
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>dataqsiz</span> <span class=kt>uint</span>           <span class=c1>// size of the circular queue
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>buf</span>      <span class=nx>unsafe</span><span class=p>.</span><span class=nx>Pointer</span> <span class=c1>// points to an array of dataqsiz elements
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>elemsize</span> <span class=kt>uint16</span>
</span></span><span class=line><span class=cl>    <span class=nx>closed</span>   <span class=kt>uint32</span>
</span></span><span class=line><span class=cl>    <span class=nx>elemtype</span> <span class=o>*</span><span class=nx>_type</span> <span class=c1>// element type
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>sendx</span>    <span class=kt>uint</span>   <span class=c1>// send index
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>recvx</span>    <span class=kt>uint</span>   <span class=c1>// receive index
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>recvq</span>    <span class=nx>waitq</span>  <span class=c1>// list of recv waiters
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>sendq</span>    <span class=nx>waitq</span>  <span class=c1>// list of send waiters
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// lock protects all fields in hchan, as well as several
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// fields in sudogs blocked on this channel.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// Do not change another G&#39;s status while holding this lock
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// (in particular, do not ready a G), as this can deadlock
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// with stack shrinking.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>lock</span> <span class=nx>mutex</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>interface</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>iface</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>tab</span>  <span class=o>*</span><span class=nx>itab</span>
</span></span><span class=line><span class=cl>    <span class=nx>data</span> <span class=nx>unsafe</span><span class=p>.</span><span class=nx>Pointer</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>eface</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>_type</span> <span class=o>*</span><span class=nx>_type</span>
</span></span><span class=line><span class=cl>    <span class=nx>data</span>  <span class=nx>unsafe</span><span class=p>.</span><span class=nx>Pointer</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>func 和 pointer 本身就是一个指针。</p><p>可以看出，map 和 chan 两个都是比较大的结构体，而当你声明一个 map 或 chan 时，你必须通过 <code>make()</code> 才能使用。为什么？</p><p>因为这两个结构体比较大，为了提高性能，你声明的时候 <code>var c chan int</code> 的时候，c 是个指针，当你 <code>make()</code> 的时候才会分配内存，也就是初始化 <code>hchan</code>。map 也是同样的道理。</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/TCP404/Picgo//blog/illustration-pic/Go/IMG/IMG20210821110117.png alt></p><p>像图中那样，slice、map、chan、interface 不管他们有多大，例如 slice 有 1000 个元素，map 有 10万对键值对，chan 缓存中有 100万 个数据，那都是他们背后的数组的大小；他们本身的大小，只有一个结构体那么大。</p><p>所以编译器在判断 nil 的时候其实非常快，因为这几个类型本身是指针，编译器只需要像如下判断即可：</p><ul><li>对于 slice 的时候，判断 s 中的 array 字段是不是零值；</li><li>对于 map、chan 的时候，判断 m、c 自身是不是零值；</li><li>对于 interface 的时候，判断 i 自身是不是零值；</li><li>对于 pointer、func 的时候，判断 p、f 自身是不是零值；</li></ul><p>同样，在赋值 nil 的时候，也是把他们自身赋值为 nil 即可。</p><p>除了 slice，因为它的结构比较小，总共就 24Byte（32位机中 12B），所以声明的时候直接初始化了一个 slice 结构，对 array 字段进行维护。</p><p>具体细节，推荐仔细阅读 <a href=https://mp.weixin.qq.com/s/sHLYy_4XA6254-vLmlu0IA>https://mp.weixin.qq.com/s/sHLYy_4XA6254-vLmlu0IA</a>，这篇文章讲的非常通俗和详细。</p><h2 id=总结>总结<a hidden class=anchor aria-hidden=true href=#总结>#</a></h2><ol><li>nil 只能用于引用六兄弟 SMCIFP；</li><li>变量只是一个指向一块内存的指针</li><li>slice 结构较小，所以声明的时候就直接分配内存了，map 和 chan 需要 make() 才分配内存。</li><li>除了 pointer 和 func，其他都是使用对应结构体来管理</li><li>对 MCIFP 的判断 nil 和 赋值 nil，都是对变量本身进行操作，而 Slice 是对 array 字段进行操作。</li></ol><p>再次强烈推荐阅读 <a href=https://mp.weixin.qq.com/s/sHLYy_4XA6254-vLmlu0IA>https://mp.weixin.qq.com/s/sHLYy_4XA6254-vLmlu0IA</a>。</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://boii.xyz/tags/golang/>Golang</a></li><li><a href=https://boii.xyz/tags/%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B/>引用类型</a></li></ul><nav class=paginav><a class=prev href=https://boii.xyz/posts/go/golang-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3-9-%E5%80%BC%E5%AE%9E%E7%8E%B0-vs-%E6%8C%87%E9%92%88%E5%AE%9E%E7%8E%B0/><span class=title>« Prev Page</span><br><span>Golang [深入理解] 9-值实现 VS 指针实现</span></a>
<a class=next href=https://boii.xyz/posts/go/golang-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3-4-string-%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86/><span class=title>Next Page »</span><br><span>Golang [深入理解] 4-string 实现原理</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Golang [深入理解] 7-关于 nil on twitter" href="https://twitter.com/intent/tweet/?text=Golang%20%5b%e6%b7%b1%e5%85%a5%e7%90%86%e8%a7%a3%5d%207-%e5%85%b3%e4%ba%8e%20nil&url=https%3a%2f%2fboii.xyz%2fposts%2fgo%2fgolang-%25E6%25B7%25B1%25E5%2585%25A5%25E7%2590%2586%25E8%25A7%25A3-7-%25E5%2585%25B3%25E4%25BA%258E-nil%2f&hashtags=Golang%2c%e5%bc%95%e7%94%a8%e7%b1%bb%e5%9e%8b"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Golang [深入理解] 7-关于 nil on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fboii.xyz%2fposts%2fgo%2fgolang-%25E6%25B7%25B1%25E5%2585%25A5%25E7%2590%2586%25E8%25A7%25A3-7-%25E5%2585%25B3%25E4%25BA%258E-nil%2f&title=Golang%20%5b%e6%b7%b1%e5%85%a5%e7%90%86%e8%a7%a3%5d%207-%e5%85%b3%e4%ba%8e%20nil&summary=Golang%20%5b%e6%b7%b1%e5%85%a5%e7%90%86%e8%a7%a3%5d%207-%e5%85%b3%e4%ba%8e%20nil&source=https%3a%2f%2fboii.xyz%2fposts%2fgo%2fgolang-%25E6%25B7%25B1%25E5%2585%25A5%25E7%2590%2586%25E8%25A7%25A3-7-%25E5%2585%25B3%25E4%25BA%258E-nil%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Golang [深入理解] 7-关于 nil on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fboii.xyz%2fposts%2fgo%2fgolang-%25E6%25B7%25B1%25E5%2585%25A5%25E7%2590%2586%25E8%25A7%25A3-7-%25E5%2585%25B3%25E4%25BA%258E-nil%2f&title=Golang%20%5b%e6%b7%b1%e5%85%a5%e7%90%86%e8%a7%a3%5d%207-%e5%85%b3%e4%ba%8e%20nil"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Golang [深入理解] 7-关于 nil on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fboii.xyz%2fposts%2fgo%2fgolang-%25E6%25B7%25B1%25E5%2585%25A5%25E7%2590%2586%25E8%25A7%25A3-7-%25E5%2585%25B3%25E4%25BA%258E-nil%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Golang [深入理解] 7-关于 nil on whatsapp" href="https://api.whatsapp.com/send?text=Golang%20%5b%e6%b7%b1%e5%85%a5%e7%90%86%e8%a7%a3%5d%207-%e5%85%b3%e4%ba%8e%20nil%20-%20https%3a%2f%2fboii.xyz%2fposts%2fgo%2fgolang-%25E6%25B7%25B1%25E5%2585%25A5%25E7%2590%2586%25E8%25A7%25A3-7-%25E5%2585%25B3%25E4%25BA%258E-nil%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Golang [深入理解] 7-关于 nil on telegram" href="https://telegram.me/share/url?text=Golang%20%5b%e6%b7%b1%e5%85%a5%e7%90%86%e8%a7%a3%5d%207-%e5%85%b3%e4%ba%8e%20nil&url=https%3a%2f%2fboii.xyz%2fposts%2fgo%2fgolang-%25E6%25B7%25B1%25E5%2585%25A5%25E7%2590%2586%25E8%25A7%25A3-7-%25E5%2585%25B3%25E4%25BA%258E-nil%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://boii.xyz/>Mr.Boii</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="copy";function s(){e.innerText="copied!",setTimeout(()=>{e.innerText="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>